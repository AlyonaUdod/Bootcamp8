"use strict";function _toConsumableArray(r){if(Array.isArray(r)){for(var e=0,t=Array(r.length);e<r.length;e++)t[e]=r[e];return t}return Array.from(r)}var cardsArr=[],input=document.querySelector(".form__input"),addCard=document.querySelector(".form__submit"),form=document.querySelector(".form"),divWrap=document.querySelector(".wrapper"),inputValue=void 0,regExp=/^[a-z]{1,}\.[a-z]{1,}\.?\w{1,}([a-zA-Z0-9]{1,}|.?)?/;function isUrlValid(r){r.preventDefault();var e=input.value;0===input.value.length?alert("Please enter url before adding card."):regExp.test(e)?getInfoAboutLink(r):alert("Url is invalid! Enter valid url, please.")}function getInfoAboutLink(r){r.preventDefault(),fetch("https://api.linkpreview.net/?key=5bfda7235645423745dd9b252ba856cdd795b606a47ea&q=https://www."+input.value).then(function(r){return r.json()}).then(function(r){return addLinkToArr(r)}).catch(function(r){return console.log(r)})}function addLinkToArr(r){if(console.log(r),424===r.error)alert("Sorry, my app can't create card without info from server. Please enter another url. Error: "+r.description),form.reset();else{form.reset();var e={url:r.url,title:r.title,image:r.image,description:r.description};if(cardsArr.length>0)cardsArr.map(function(r){return r.description}).includes(e.description)?alert("Card already exist! Please enter another url."):(cardsArr.push(e),createCard(r),localStorage.setItem("arrCards",JSON.stringify(cardsArr)));else cardsArr.push(e),createCard(r),localStorage.setItem("arrCards",JSON.stringify(cardsArr))}}function createCard(r){var e=document.querySelector("#cards-template").innerHTML.trim(),t=Handlebars.compile(e)(r);divWrap.insertAdjacentHTML("afterbegin",t)}function removeCard(r){"delete"===r.target.className&&(cardsArr=cardsArr.filter(function(e){return e.url!==[].concat(_toConsumableArray(r.target.parentNode.children))[2].children[0].href}),r.target.parentNode.remove(),localStorage.setItem("arrCards",JSON.stringify(cardsArr)))}function isLocalStorageFull(){null!==localStorage.getItem("arrCards")&&createCardsFromLocalStorage()}function createCardsFromLocalStorage(){(cardsArr=JSON.parse(localStorage.getItem("arrCards"))).map(function(r){return createCard(r)})}console.log(regExp),addCard.addEventListener("click",isUrlValid),divWrap.addEventListener("click",removeCard),window.addEventListener("DOMContentLoaded",isLocalStorageFull);