"use strict";function _toConsumableArray(r){if(Array.isArray(r)){for(var e=0,t=Array(r.length);e<r.length;e++)t[e]=r[e];return t}return Array.from(r)}var cardsArr=[],input=document.querySelector(".form__input"),addCard=document.querySelector(".form__submit"),form=document.querySelector(".form"),divWrap=document.querySelector(".wrapper"),regExp=/^[a-z]{1,}\.\w{2,3}/;function isUrlValid(r){r.preventDefault();var e=input.value;0===input.value.length?alert("Please enter url!"):regExp.test(e)?getInfoAboutLink(r):alert("Url is invalid!")}function getInfoAboutLink(r){r.preventDefault(),fetch("https://api.linkpreview.net/?key=5bfda7235645423745dd9b252ba856cdd795b606a47ea&q=https://www."+input.value).then(function(r){return r.json()}).then(function(r){return addLinkToArr(r)}).catch(function(r){return console.log(r)})}function addLinkToArr(r){if(console.log(r.error),424===r.error)alert("Url doesn't exist!"),form.reset();else{form.reset();var e={url:r.url,title:r.title,image:r.image,description:r.description};if(cardsArr.length>0)cardsArr.map(function(r){return r.description}).includes(e.description)?alert("Закладка уже существует!"):(cardsArr.push(e),createCard(r),localStorage.setItem("arrCards",JSON.stringify(cardsArr)));else cardsArr.push(e),createCard(r),localStorage.setItem("arrCards",JSON.stringify(cardsArr))}}function createCard(r){var e=document.querySelector("#cards-template").innerHTML.trim(),t=Handlebars.compile(e)(r);divWrap.insertAdjacentHTML("afterbegin",t)}function removeCard(r){"delete"===r.target.className&&(cardsArr=cardsArr.filter(function(e){return e.image!==[].concat(_toConsumableArray(r.target.parentNode.children))[1].src}),r.target.parentNode.remove(),localStorage.setItem("arrCards",JSON.stringify(cardsArr)))}function isLocalStorageFull(){null!==localStorage.getItem("arrCards")&&createCardsFromLocalStorage()}function createCardsFromLocalStorage(){(cardsArr=JSON.parse(localStorage.getItem("arrCards"))).map(function(r){return createCard(r)})}console.log(regExp),addCard.addEventListener("click",isUrlValid),divWrap.addEventListener("click",removeCard),window.addEventListener("DOMContentLoaded",isLocalStorageFull);